/******************************************************Copyright (c)**************************************************
**                                              胆怯是阻止一切可能的根本缘由
**
**                                             E-Mail: ChinaFengliang@163.com
**
**---------File Information-------------------------------------------------------------------------------------------
** File name:            led.c
** Last version:         V1.00
** Descriptions:         指示灯驱动文件.
** Hardware platform:    CAN中继器lpc1768之pin(0.15)
** SoftWare platform:    ChinaOS
**
**--------------------------------------------------------------------------------------------------------------------
** Created by:           Fengliang
** Created date:         2010年10月13日  14:10:22
** Version:              V1.00
** Descriptions:         占用资源: pin 2.5
**
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Version:
** Descriptions:
**
*********************************************************************************************************************/

/*********************************************************************************************************************
                                                    头文件区
*********************************************************************************************************************/
#include    <include/macro.h>
#include    <include/types.h>
#include    <library/ioport.h>
#include    "../../lpc17xx.h"
#include    "./led2.h"

/*********************************************************************************************************************
                                                    宏定义区
*********************************************************************************************************************/
/* 宏段名 ----------------------------------------------------------------------------------------------------------*/



/*********************************************************************************************************************
                                                    类型定义区
*********************************************************************************************************************/
/* 基本类型 --------------------------------------------------------------------------------------------------------*/



/*********************************************************************************************************************
                                                  全局变量定义区
*********************************************************************************************************************/



/*********************************************************************************************************************
** Function name:           led2_setup
** Descriptions:            安装指示灯
** Input parameters:        none
** Output parameters:       none
** Returned value:          ==OK : 操作成功
**                          !=OK : 操作失败(包含出错信息)
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-10-13  14:30:0
** Test recorde:
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
static STATUS led2_setup(void)
{
    /* led2 控制引脚: p0.15 */
    dword_clear_bits(PINSEL0, 3ul << 30);                                   /* 配置引脚p0.15功能: GPIO              */
    dword_set_bits(FIO0DIR, 1ul << 15);                                     /* 配置引脚p0.15方向: 输出              */

    return OK;
}

/*********************************************************************************************************************
** Function name:           led2_on
** Descriptions:            打开指示灯
** Input parameters:        none
** Output parameters:       none
** Returned value:          none
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-10-13  14:30:35
** Test recorde:
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
static void led2_on(void)
{
    write_dword(FIO0CLR, 1ul << 15);                                        /* 打开指示灯                           */
}

/*********************************************************************************************************************
** Function name:           led2_off
** Descriptions:            关闭指示灯
** Input parameters:        none
** Output parameters:       none
** Returned value:          none
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-10-13  14:30:43
** Test recorde:
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
static void led2_off(void)
{
    write_dword(FIO0SET, 1ul << 15);                                        /* 关闭指示灯                           */
}

/*********************************************************************************************************************
                                                    设备定义区
*********************************************************************************************************************/
const CLASS_LED led2 =                                                      /* 设备: 指示灯                         */
{
    led2_setup,
    led2_on,
    led2_off,
};
EXPORT_TO_DEVICE(led2, "运行指示灯");

/*********************************************************************************************************************
                                                    END OF FILE
*********************************************************************************************************************/

