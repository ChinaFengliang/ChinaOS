/******************************************************Copyright (c)**************************************************
**
**                              Copyright (c) 2009,2011 Fengliang And His Friends Corporation.
**
**                                             E-Mail: ChinaFengliang@163.com
**
**
**---------File Information-------------------------------------------------------------------------------------------
** File name:            syscall.h
** Last version:         V1.00
** Descriptions:         系统服务调用接口文件.
** Hardware platform:    Cortex-M3
** SoftWare platform:    ChinaOS
**
**--------------------------------------------------------------------------------------------------------------------
** Created by:           FengLiang
** Created date:         2011年7月19日  23:14:28
** Version:              V1.00
** Descriptions:         The original version
**
**--------------------------------------------------------------------------------------------------------------------
** Modified by: 
** Modified date:
** Version:
** Descriptions:
**
*********************************************************************************************************************/
#ifndef __SYSCALL_H
#define __SYSCALL_H

#ifdef __cplusplus
extern "C" {
#endif                                                                      /* __cplusplus                          */

/*********************************************************************************************************************
                                                    头文件区
*********************************************************************************************************************/
#include    <include/macro.h>

/*********************************************************************************************************************
                                                    宏定义区
*********************************************************************************************************************/
/* 宏段名 ----------------------------------------------------------------------------------------------------------*/
__svc(0x00)                 int system_call1(int Type);                     /* 单参数系统调用(ARMCC定义)            */
__svc(0x01)                 int system_call2(int Type, int Index);          /* 双参数系统调用(ARMCC定义)            */

/*********************************************************************************************************************
                                                    类型定义区
*********************************************************************************************************************/
/* 基本类型 --------------------------------------------------------------------------------------------------------*/

extern int static_atom_operate_lock(void);
extern void static_atom_operate_unlock(int Key);
/*********************************************************************************************************************
** Function name:           OS_thread_switch
** Descriptions:            上下文切换
** Input parameters:        none
** Output parameters:       none
** Returned value:          none
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-9-2  11:23:56
** Test recorde:            通过测试
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
INLINE void OS_thread_switch(void)
{
    system_call1(0);
}

/*********************************************************************************************************************
** Function name:           OS_activate_system
** Descriptions:            激活操作系统
** Input parameters:        None
** Output parameters:       None
** Returned value:          None
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-9-2  14:17:31
** Test recorde:            通过测试
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
INLINE void OS_activate_system(void)
{
    system_call1(1);
}

/*********************************************************************************************************************
** Function name:           OS_system_restart
** Descriptions:            重启系统(此接口不导出给用户)
** Input parameters:
** Output parameters:
** Returned value:
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-9-6  11:0:31
** Test recorde:
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
INLINE void OS_system_restart(void)
{
    system_call1(2);
}

/*********************************************************************************************************************
** Function name:           atom_operate_lock
** Descriptions:            原子操作锁定
** Input parameters:        
** Output parameters:       
** Returned value:          解锁密钥
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-9-2  11:27:25
** Test recorde:            通过测试
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
INLINE int atom_operate_lock(void)
{
    return static_atom_operate_lock();
}

/*********************************************************************************************************************
** Function name:           atom_operate_unlock
** Descriptions:            原子操作解锁
** Input parameters:        Key : 密钥
** Output parameters:       
** Returned value:          
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2010-9-2  11:28:50
** Test recorde:            通过测试
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde:
*********************************************************************************************************************/
INLINE void atom_operate_unlock(int Key)
{
    static_atom_operate_unlock(Key);
}

#ifdef __cplusplus
}
#endif                                                                      /* __cplusplus                          */

#endif                                                                      /* end of __SYSCALL_H                   */

/*********************************************************************************************************************
                                                    END OF FILE
*********************************************************************************************************************/

