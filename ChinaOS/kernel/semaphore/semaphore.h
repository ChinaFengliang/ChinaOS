/******************************************************Copyright (c)**************************************************
**
**                              Copyright (c) 2009,2011 Fengliang And His Friends Corporation.
**
**                                             E-Mail: ChinaFengliang@163.com
**
**
**---------File Information-------------------------------------------------------------------------------------------
** File name:            semaphore.h
** Last version:         V1.00
** Descriptions:         系统之数据类型头文件.
** Hardware platform:    
** SoftWare platform:
**
**--------------------------------------------------------------------------------------------------------------------
** Created by:           FengLiang
** Created date:         2011年2月25日  14:7:22
** Version:              V1.00
** Descriptions:         The original version
**
**--------------------------------------------------------------------------------------------------------------------
** Modified by: 
** Modified date:
** Version:
** Descriptions:
**
*********************************************************************************************************************/
#ifndef __SEMAPHORE_H
#define __SEMAPHORE_H

#ifdef __cplusplus
extern "C" {
#endif                                                                      /* __cplusplus                          */

/*********************************************************************************************************************
                                                    头文件区
*********************************************************************************************************************/
#include    "../kernel.h"
#include    <library/link/list.h>

/*********************************************************************************************************************
                                                    宏定义区
*********************************************************************************************************************/
/* 宏段名 ----------------------------------------------------------------------------------------------------------*/


/*********************************************************************************************************************
                                                    类型定义区
*********************************************************************************************************************/
/* 邮件箱类型 ------------------------------------------------------------------------------------------------------*/
struct semaphore
{
    int                 Status;                                             /* 信号量状态                           */
    INT32U              Counter;                                            /* 计数器                               */
    struct list_head    WaitHead;                                           /* 收取线程                             */
};
typedef struct semaphore                         *SEMAPHORE;                /* 信号量类型                           */

/*********************************************************************************************************************
** Function name:           semaphore_new
** Descriptions:            新建信号量
** Input parameters:        Amount : 初始数量
** Output parameters:       
** Returned value:          ==NULL : 操作失败
**                          !=NULL : 操作成功(包含消息邮箱)
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2011-2-25  14:9:48
** Test recorde:            
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde: 
*********************************************************************************************************************/
SEMAPHORE semaphore_new(INT32U Amount);

/*********************************************************************************************************************
** Function name:           semaphore_free
** Descriptions:            释放信号量
** Input parameters:        Semaphore : 信号量
** Output parameters:       
** Returned value:          ==OS_OK : 操作成功
**                          !=OS_OK : 操作失败(包含出错信息)
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2011-4-13  2:33:9
** Test recorde:            
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde: 
*********************************************************************************************************************/
int semaphore_free(SEMAPHORE Semaphore);

/*********************************************************************************************************************
** Function name:           semaphore_setup
** Descriptions:            创建信号量
** Input parameters:        Semaphore : 信号量地址
**                          Amount    : 初始数量
** Output parameters:       
** Returned value:          ==OS_OK : 操作成功
**                          !=OS_OK : 操作失败(包含出错信息)
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2011-2-25  14:9:48
** Test recorde:            
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde: 
*********************************************************************************************************************/
int semaphore_create(SEMAPHORE Semaphore, INT32U Amount);

/*********************************************************************************************************************
** Function name:           mail_fetch
** Descriptions:            获取信号量(非阻塞方式). 
** Input parameters:        Semaphore : 信号量地址
** Output parameters:       
** Returned value:          ==OS_OK : 操作成功。信号量非零,获取信号量成功.
**                          !=OS_OK : 操作失败. 信号量为零,获取信号量失败.
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2011-5-10  18:20:52
** Test recorde:            
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde: 
*********************************************************************************************************************/
int semaphore_fetch(SEMAPHORE Semaphore);

/*********************************************************************************************************************
** Function name:           semaphore_wait
** Descriptions:            等待信号量
** Input parameters:        Semaphore : 信号量
**                          Timeout   : 等待时间
** Output parameters:       
** Returned value:          ==OS_OK : 操作成功
**                          !=OS_OK : 操作失败(包含出错信息)
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2011-2-25  14:20:38
** Test recorde:            
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde: 
*********************************************************************************************************************/
int semaphore_wait(SEMAPHORE Semaphore, INT32U Timeout);

/*********************************************************************************************************************
** Function name:           semaphore_post
** Descriptions:            投递信号量
** Input parameters:        Semaphore : 信号量
** Output parameters:       
** Returned value:          ==OS_OK : 操作成功
**                          !=OS_OK : 操作失败(包含出错信息)
**--------------------------------------------------------------------------------------------------------------------
** Created by:              Fengliang
** Created Date:            2011-2-25  14:22:16
** Test recorde:            
**--------------------------------------------------------------------------------------------------------------------
** Modified by:
** Modified date:
** Test recorde: 
*********************************************************************************************************************/
int semaphore_post(SEMAPHORE Semaphore);


#ifdef __cplusplus
}
#endif                                                                      /* __cplusplus                          */

#endif                                                                      /* end of __SEMAPHORE_H                 */

/*********************************************************************************************************************
                                                    END OF FILE
*********************************************************************************************************************/

